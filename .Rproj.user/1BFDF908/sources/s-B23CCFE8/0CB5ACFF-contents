#Code to Resize Images from Larger jpegs to Thumbnails

#Admin####
library(readxl)
library(imager)

#Vectors & Data####
  p<-read_excel("portfolio.xlsx",sheet="portfolio")
    p<-subset(p,Include=="Yes")
  
  images<-as.vector(interaction(levels(as.factor(p$Filename)),"jpg"))
    #Only updating those without existing thumbnails to save time
    images<-images[which(file.exists(paste("portfolio_thumb/",images,sep=""))==T)]
  
  input<-"portfolio/"
  output<-"portfolio_thumb/"

#Loop Through Images
  
  for(i in images){
    input_name<-paste(input,i,sep="")
    output_name<-paste(output,i,sep="")
    
    im<-load.image(input_name)
      w<-width(im)
      h<-height(im)
      s<- if(h<1000) {2} else {10}  
      
    thmb<-resize(im,round(w/s),round(h/s))

    save.image(thmb,output_name)
  }
  